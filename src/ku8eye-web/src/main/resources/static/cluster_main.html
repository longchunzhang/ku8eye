<style>
	ul li{list-style-type:none;}
	.installationMode{
		width:90%;
		height:100%;
		margin:0 auto;
	}
	.installationMode tr th{
		padding:4% 10% 4% 9% ;
		text-align:left;
	}
	.installationMode ul{
		padding:4% 1% 4% 10% ;
        color: #ffffff;
        border-radius: 8px;
		background-color:#880015;
	}
	.installationMode ul h3{
		font-weight: 600;
		padding-bottom:15px;
	}
	.installationMode ul .mode_li{
		padding-left:40px;
	}
</style>

<div class="row">
	<div class="col-xs-12">
		<div class="box">
			<!-- /.box-header -->
			<div class="box-body">
				<div style="padding-bottom: 5px;">	
					<h1 id="installtitle">您的计算机软件未安装，请安装！</h1>
				</div>

				<table id="example1" class="installationMode">
					<thead>
						
					</thead>
				</table>
			</div>
			<!-- /.box-body -->
		</div>
		<!-- /.box -->
	</div>
	<!-- /.col -->
</div>
<!-- /.row -->
<script>
//$.dailyInit();
$.ajax({
    url:"/clusterlist/1",
    type: "GET",
    dataType:"json",
    success: function(data){
    	$.each(data,function(i,item){
    		if(item.installType==1){
    			install();
    		}else{
    			installed();
    		}
    	});
    }
}); 

function install(){
	$.ajax({
	    url:"/deploycluster/listtemplates",
	    type: "GET",
	    dataType:"json",
	    success: function(data){
	    	var count=1;
			var tableList="";
	        $.each(data,function(i,item){
	        	tableList += [
	                 count%2==1?'<tr>':'',
	                 count%2==1?'<th id="'+item.id+'" c="'+item.maxNodes+'"><ul class="Mode"><li><h3>'+item.name+'</h3></li><li class="mode_li">要求：最少'+item.minNodes+'节点,最大'+item.maxNodes+'节点</li><li class="mode_li">'+item.describe+'</li></ul></th>':'',
	                 count%2==0?'<th id="'+item.id+'" c="'+item.maxNodes+'"><ul><li><h3>'+item.name+'</h3></li><li class="mode_li">要求：最少'+item.minNodes+'节点,最大'+item.maxNodes+'节点</li><li class="mode_li">'+item.describe+'</li></ul></th>':'',
	                 count%2==0?'</tr>':''
	            ].join('');
	           
	            count++;
	        }); 
	       
	        $("#example1").html(tableList);  
	        
	        $( '#example1' ).find('th').bind('click',function(){
	        	if($( this ).attr('c')==1){
	        		$(".content").load("singleNode.html");
	        	}else{
	        		$(".content").load("multiNode.html");
	        	}
	        	
			});
	    }
	});
}

function installed(){
	$("#installtitle").html("已完成安装！！！！");
	$.ajax({
	    url:"/deploycluster/nodeslist",
	    type: "GET",
	    dataType:"json",
	    success: function(data){
	    	$.each(data,function(i,item){
	    		var nodeRole="";
	    		$.each(item.nodeRoleParams,function(m,n){
	    			nodeRole+=m+";";
	    		});
	    		$("#example1").append("<tr><td>"+item.ip+"</td><td>"+nodeRole+"</td><td class='detected'>检测成功</td></tr>");
	    	});
	    	
	    }
	});
}

</script>
